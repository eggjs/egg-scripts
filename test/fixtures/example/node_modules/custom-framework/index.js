'use strict';

const egg = require('../../../../../node_modules/egg');

const originStartCluster = egg.startCluster;

module.exports = Object.assign(egg, {
  Application: class CustomApplication extends egg.Application {
    get [Symbol.for('egg#eggPath')]() {
      return __dirname;
    }
  },
  startCluster(...args) {
    if (process.env.TEST_EXIT) {
      setTimeout(() => {
        console.log('exist by env');
        process.kill(process.pid, 'SIGTERM');
      }, process.env.TEST_EXIT);
    }
    originStartCluster(...args);
  }
});
