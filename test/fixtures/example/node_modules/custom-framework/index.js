'use strict';

const egg = require('../../../../../node_modules/egg');

const originStartCluster = egg.startCluster;

module.exports = Object.assign(egg, {
  Application: class CustomApplication extends egg.Application {
    get [Symbol.for('egg#eggPath')]() {
      return __dirname;
    }
  },
  startCluster(...args) {
    if (process.env.CUSTOM_ENV && !process.env.EGG_SERVER_ENV) {
      console.log('## EGG_SERVER_ENV is not pass');
      console.log('## CUSTOM_ENV:', process.env.CUSTOM_ENV);
      process.env.EGG_SERVER_ENV = process.env.CUSTOM_ENV;
    }
    return originStartCluster(...args);
  },
});
